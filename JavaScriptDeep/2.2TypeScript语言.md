## 类型系统

TypeScript 解决 JavaScript 类型系统的问题，大大提高代码的可靠程度

- JavaScript 缺失类型系统的可靠性（不靠谱）
- JavaScript 没有编译环节，静态类型在编译环节进行类型校验

### 强类型与弱类型（类型安全）

- 强类型：语言层面显示函数的实参类型必须与形参类型相同（更强的类型约束）

  不允许任意的隐式类型转换

- 弱类型：语言层面不会限制实参的类型（几乎没有约束）

  允许任意的隐式类型转换

注意：变量类型允许随时改变的特点，不是强弱类型的差异

```bash
# node 环境
> '100' - 50
50
> Math.abs('foo')
NaN
> .exit

# python 环境
>>> '100' - 50
TypeError: unsupported operand type(s) for -: 'str' and 'int'
>>> abs('foo')
TypeError: bad operand type for abs(): 'str'
>>> exit()
```

**弱类型的问题**

```js
// 程序上的异常需要等到运行时才能发现
const obj = {}
setTimeout(() => {
  obj.foo()
}, 2000)

// 类型不明确造成功能改变
function sum(a, b) {
  return a + b
}
console.log(100, '100')

// 对象索引错误用法
obj[true] = 100
console.log(foo['true'])
```

**强类型的优势**

- 错误更早暴露（编译阶段报错）

- 代码更智能，编码更准确

  ```js
  function render(element) {
    element.className = 'container'
  }
  ```

- 重构更牢靠

  ```js
  const util = {
    // 不知道哪里用到 aaa 了
    aaa: () => {
      console.log('util func')
    },
  }
  ```

- 减少不必要的类型判断

  ```js
  function sum(a, b) {
    if (typeof a !== 'number' || typeof b !== 'number') {
      throw new Error('arguments must be a number')
    }
    return a + b
  }
  ```

### 静态类型与动态类型（类型检查）

- 静态类型：一个变量声明时它的类型就是明确的，声明过后类型就不允许再修改
- 动态类型：运行阶段才能够明确变量类型，而且变量的类型随时可以改变

```js
var foo = 100
foo = 'bar'
foo = true
console.log(foo)
```

## Flow 静态类型检查方案

- 类型注解 `function sum (a: number)`

```bash
yarn add flow-bin --dev
```

使用 flow

- 执行 `yarn flow` 时可能会报错：`error Command failed with exit code 2.`

```bash
yarn flow init
yarn flow
```



## Typescript 语言规范与基本应用